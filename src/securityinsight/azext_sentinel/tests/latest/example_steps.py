# --------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for
# license information.
#
# Code generated by Microsoft (R) AutoRest Code Generator.
# Changes may cause incorrect behavior and will be lost if the code is
# regenerated.
# --------------------------------------------------------------------------


from .. import try_manual


# EXAMPLE: /Actions/put/Creates or updates an action of alert rule.
@try_manual
def step_action_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel action create '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--logic-app-resource-id "/subscriptions/{subscription_id}/resourceGroups/{rg}/providers/Microsoft.Logic/w'
             'orkflows/MyAlerts" '
             '--trigger-uri "https://prod-31.northcentralus.logic.azure.com:443/workflows/cd3765391efd48549fd7681ded1d4'
             '8d7/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=signatur'
             'e" '
             '--action-id "912bec42-cb66-4c03-ac63-1761b6898c3e" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Actions/get/Get all actions of alert rule.
@try_manual
def step_action_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel action list '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Actions/get/Get an action of alert rule.
@try_manual
def step_action_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel action show '
             '--action-id "912bec42-cb66-4c03-ac63-1761b6898c3e" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AutomationRules/put/AutomationRules_CreateOrUpdate
@try_manual
def step_automation_rule_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel automation-rule create '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--actions actionConfiguration={{"severity":"High"}} action-type="ModifyProperties" order=1 '
             '--display-name "High severity incidents escalation" '
             '--order 1 '
             '--conditions conditionProperties={{"operator":"Contains","propertyName":"IncidentRelatedAnalyticRuleIds",'
             '"propertyValues":["/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Micr'
             'osoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRules/fab3d2d4'
             '-747f-46a7-8ef0-9c0be8112bf7","/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/pr'
             'oviders/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRu'
             'les/8deb8303-e94d-46ff-96e0-5fd94b33df1a"]}} condition-type="Property" '
             '--conditions conditionProperties={{"changeType":"ChangedFrom","operator":"Equals","propertyName":"Inciden'
             'tStatus","propertyValues":["Closed"]}} condition-type="PropertyChanged" '
             '--conditions conditionProperties={{"arrayType":"Alerts","changeType":"Added"}} '
             'condition-type="PropertyArrayChanged" '
             '--is-enabled true '
             '--triggers-when "Created" '
             '--automation-rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Actions/delete/Delete an action of alert rule.
@try_manual
def step_action_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel action delete -y '
             '--action-id "912bec42-cb66-4c03-ac63-1761b6898c3e" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/put/Creates or updates a Fusion alert rule with scenario exclusion pattern.
@try_manual
def step_alert_rule_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule create '
             '--alert-rule "{{\\"etag\\":\\"3d00c3ca-0000-0100-0000-5d42d5010000\\",\\"kind\\":\\"Fusion\\",\\"properti'
             'es\\":{{\\"alertRuleTemplateName\\":\\"f71aba3d-28fb-450b-b192-4e76a83015c8\\",\\"enabled\\":true,\\"sour'
             'ceSettings\\":[{{\\"enabled\\":true,\\"sourceName\\":\\"Anomalies\\",\\"sourceSubTypes\\":null}},{{\\"ena'
             'bled\\":true,\\"sourceName\\":\\"Alert providers\\",\\"sourceSubTypes\\":[{{\\"enabled\\":true,\\"severit'
             'yFilters\\":{{\\"filters\\":[{{\\"enabled\\":true,\\"severity\\":\\"High\\"}},{{\\"enabled\\":true,\\"sev'
             'erity\\":\\"Medium\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Low\\"}},{{\\"enabled\\":true,\\"severity'
             '\\":\\"Informational\\"}}]}},\\"sourceSubTypeName\\":\\"Azure Active Directory Identity '
             'Protection\\"}},{{\\"enabled\\":true,\\"severityFilters\\":{{\\"filters\\":[{{\\"enabled\\":true,\\"sever'
             'ity\\":\\"High\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Medium\\"}},{{\\"enabled\\":true,\\"severity\\'
             '":\\"Low\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Informational\\"}}]}},\\"sourceSubTypeName\\":\\"Azu'
             're Defender\\"}},{{\\"enabled\\":true,\\"severityFilters\\":{{\\"filters\\":[{{\\"enabled\\":true,\\"seve'
             'rity\\":\\"High\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Medium\\"}},{{\\"enabled\\":true,\\"severity'
             '\\":\\"Low\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Informational\\"}}]}},\\"sourceSubTypeName\\":\\"A'
             'zure Defender for IoT\\"}},{{\\"enabled\\":true,\\"severityFilter\\":[\\"High\\",\\"Medium\\",\\"Low\\",'
             '\\"Informational\\"],\\"severityFilters\\":{{\\"filters\\":[{{\\"enabled\\":true,\\"severity\\":\\"High\\'
             '"}},{{\\"enabled\\":true,\\"severity\\":\\"Medium\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Low\\"}},{{'
             '\\"enabled\\":true,\\"severity\\":\\"Informational\\"}}]}},\\"sourceSubTypeName\\":\\"Microsoft 365 '
             'Defender\\"}},{{\\"enabled\\":true,\\"severityFilters\\":{{\\"filters\\":[{{\\"enabled\\":true,\\"severit'
             'y\\":\\"High\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Medium\\"}},{{\\"enabled\\":true,\\"severity\\":'
             '\\"Low\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Informational\\"}}]}},\\"sourceSubTypeName\\":\\"Micro'
             'soft Cloud App Security\\"}},{{\\"enabled\\":true,\\"severityFilters\\":{{\\"filters\\":[{{\\"enabled\\":'
             'true,\\"severity\\":\\"High\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Medium\\"}},{{\\"enabled\\":true,'
             '\\"severity\\":\\"Low\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Informational\\"}}]}},\\"sourceSubTypeN'
             'ame\\":\\"Microsoft Defender for Endpoint\\"}},{{\\"enabled\\":true,\\"severityFilters\\":{{\\"filters\\"'
             ':[{{\\"enabled\\":true,\\"severity\\":\\"High\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Medium\\"}},{{'
             '\\"enabled\\":true,\\"severity\\":\\"Low\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Informational\\"}}]}'
             '},\\"sourceSubTypeName\\":\\"Microsoft Defender for Identity\\"}},{{\\"enabled\\":true,\\"severityFilters'
             '\\":{{\\"filters\\":[{{\\"enabled\\":true,\\"severity\\":\\"High\\"}},{{\\"enabled\\":true,\\"severity\\"'
             ':\\"Medium\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Low\\"}},{{\\"enabled\\":true,\\"severity\\":\\"In'
             'formational\\"}}]}},\\"sourceSubTypeName\\":\\"Microsoft Defender for Office '
             '365\\"}},{{\\"enabled\\":true,\\"severityFilters\\":{{\\"filters\\":[{{\\"enabled\\":true,\\"severity\\":'
             '\\"High\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Medium\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Lo'
             'w\\"}},{{\\"enabled\\":true,\\"severity\\":\\"Informational\\"}}]}},\\"sourceSubTypeName\\":\\"Azure '
             'Sentinel scheduled analytics rules\\"}}]}},{{\\"enabled\\":true,\\"sourceName\\":\\"Raw logs from other '
             'sources\\",\\"sourceSubTypes\\":[{{\\"enabled\\":true,\\"severityFilters\\":{{\\"filters\\":null}},\\"sou'
             'rceSubTypeName\\":\\"Palo Alto Networks\\"}}]}}]}}}}" '
             '--resource-group "{rg}" '
             '--rule-id "myFirstFusionRule" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/put/Creates or updates a Fusion alert rule.
@try_manual
def step_alert_rule_create2(test, checks=None):
    return step_alert_rule_create(test, checks)


# EXAMPLE: /AlertRules/put/Creates or updates a MicrosoftSecurityIncidentCreation rule.
@try_manual
def step_alert_rule_create3(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule create '
             '--alert-rule "{{\\"etag\\":\\"\\\\\\"260097e0-0000-0d00-0000-5d6fa88f0000\\\\\\"\\",\\"kind\\":\\"Microso'
             'ftSecurityIncidentCreation\\",\\"properties\\":{{\\"displayName\\":\\"testing '
             'displayname\\",\\"enabled\\":true,\\"productFilter\\":\\"Microsoft Cloud App Security\\"}}}}" '
             '--resource-group "{rg}" '
             '--rule-id "microsoftSecurityIncidentCreationRuleExample" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/put/Creates or updates a Nrt alert rule.
@try_manual
def step_alert_rule_create4(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule create '
             '--alert-rule "{{\\"etag\\":\\"\\\\\\"0300bf09-0000-0000-0000-5c37296e0000\\\\\\"\\",\\"kind\\":\\"NRT\\",'
             '\\"properties\\":{{\\"description\\":\\"\\",\\"displayName\\":\\"Rule2\\",\\"enabled\\":true,\\"eventGrou'
             'pingSettings\\":{{\\"aggregationKind\\":\\"AlertPerResult\\"}},\\"incidentConfiguration\\":{{\\"createInc'
             'ident\\":true,\\"groupingConfiguration\\":{{\\"enabled\\":true,\\"groupByEntities\\":[\\"Host\\",\\"Accou'
             'nt\\"],\\"lookbackDuration\\":\\"PT5H\\",\\"matchingMethod\\":\\"Selected\\",\\"reopenClosedIncident\\":f'
             'alse}}}},\\"query\\":\\"ProtectionStatus | extend HostCustomEntity = Computer | extend IPCustomEntity = '
             'ComputerIP_Hidden\\",\\"severity\\":\\"High\\",\\"suppressionDuration\\":\\"PT1H\\",\\"suppressionEnabled'
             '\\":false,\\"tactics\\":[\\"Persistence\\",\\"LateralMovement\\"],\\"techniques\\":[\\"T1037\\",\\"T1021'
             '\\"]}}}}" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/put/Creates or updates a Scheduled alert rule.
@try_manual
def step_alert_rule_create5(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule create '
             '--alert-rule "{{\\"etag\\":\\"\\\\\\"0300bf09-0000-0000-0000-5c37296e0000\\\\\\"\\",\\"kind\\":\\"Schedul'
             'ed\\",\\"properties\\":{{\\"description\\":\\"An example for a scheduled rule\\",\\"alertDetailsOverride'
             '\\":{{\\"alertDescriptionFormat\\":\\"Suspicious activity was made by {{{{{{{{ComputerIP}}}}}}}}\\",\\"al'
             'ertDisplayNameFormat\\":\\"Alert from {{{{{{{{Computer}}}}}}}}\\"}},\\"customDetails\\":{{\\"OperatingSys'
             'temName\\":\\"OSName\\",\\"OperatingSystemType\\":\\"OSType\\"}},\\"displayName\\":\\"My scheduled '
             'rule\\",\\"enabled\\":true,\\"entityMappings\\":[{{\\"entityType\\":\\"Host\\",\\"fieldMappings\\":[{{\\"'
             'columnName\\":\\"Computer\\",\\"identifier\\":\\"FullName\\"}}]}},{{\\"entityType\\":\\"IP\\",\\"fieldMap'
             'pings\\":[{{\\"columnName\\":\\"ComputerIP\\",\\"identifier\\":\\"Address\\"}}]}}],\\"eventGroupingSettin'
             'gs\\":{{\\"aggregationKind\\":\\"AlertPerResult\\"}},\\"incidentConfiguration\\":{{\\"createIncident\\":t'
             'rue,\\"groupingConfiguration\\":{{\\"enabled\\":true,\\"groupByAlertDetails\\":[\\"DisplayName\\"],\\"gro'
             'upByCustomDetails\\":[\\"OperatingSystemType\\",\\"OperatingSystemName\\"],\\"groupByEntities\\":[\\"Host'
             '\\"],\\"lookbackDuration\\":\\"PT5H\\",\\"matchingMethod\\":\\"Selected\\",\\"reopenClosedIncident\\":fal'
             'se}}}},\\"query\\":\\"Heartbeat\\",\\"queryFrequency\\":\\"PT1H\\",\\"queryPeriod\\":\\"P2DT1H30M\\",\\"s'
             'everity\\":\\"High\\",\\"suppressionDuration\\":\\"PT1H\\",\\"suppressionEnabled\\":false,\\"tactics\\":['
             '\\"Persistence\\",\\"LateralMovement\\"],\\"techniques\\":[\\"T1037\\",\\"T1021\\"],\\"triggerOperator\\"'
             ':\\"GreaterThan\\",\\"triggerThreshold\\":0}}}}" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/get/Get a Fusion alert rule.
@try_manual
def step_alert_rule_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule show '
             '--resource-group "{rg}" '
             '--rule-id "myFirstFusionRule" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/get/Get a MicrosoftSecurityIncidentCreation rule.
@try_manual
def step_alert_rule_show2(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule show '
             '--resource-group "{rg}" '
             '--rule-id "microsoftSecurityIncidentCreationRuleExample" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/get/Get a Scheduled alert rule.
@try_manual
def step_alert_rule_show3(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule show '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/get/Get all alert rules.
@try_manual
def step_alert_rule_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRules/get/Get an Nrt alert rule.
@try_manual
def step_alert_rule_show4(test, checks=None):
    return step_alert_rule_show3(test, checks)


# EXAMPLE: /AlertRules/delete/Delete an alert rule.
@try_manual
def step_alert_rule_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule delete -y '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRuleTemplates/get/Get alert rule template by Id.
@try_manual
def step_alert_rule_template_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule template show '
             '--alert-rule-template-id "65360bb0-8986-4ade-a89d-af3cf44d28aa" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AlertRuleTemplates/get/Get all alert rule templates.
@try_manual
def step_alert_rule_template_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel alert-rule template list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AutomationRules/get/AutomationRules_Get
@try_manual
def step_automation_rule_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel automation-rule show '
             '--automation-rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AutomationRules/get/AutomationRules_List
@try_manual
def step_automation_rule_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel automation-rule list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /AutomationRules/delete/AutomationRules_Delete
@try_manual
def step_automation_rule_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel automation-rule delete -y '
             '--automation-rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Bookmark/post/Expand an bookmark
@try_manual
def step_bookmark_expand(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark expand '
             '--bookmark-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--end-time "2020-01-24T17:21:00.000Z" '
             '--expansion-id "27f76e63-c41b-480f-bb18-12ad2e011d49" '
             '--start-time "2019-12-25T17:21:00.000Z" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /BookmarkRelations/put/Creates or updates a bookmark relation.
@try_manual
def step_bookmark_relation_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark relation create '
             '--bookmark-id "{myBookmark}" '
             '--related-resource-id "/subscriptions/{subscription_id}/resourceGroups/{rg}/providers/Microsoft.Operation'
             'alInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/incidents/{myIncident}" '
             '--relation-name "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /BookmarkRelations/get/Get a bookmark relation.
@try_manual
def step_bookmark_relation_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark relation show '
             '--bookmark-id "{myBookmark}" '
             '--relation-name "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /BookmarkRelations/get/Get all bookmark relations.
@try_manual
def step_bookmark_relation_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark relation list '
             '--bookmark-id "{myBookmark}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /BookmarkRelations/delete/Delete the bookmark relation.
@try_manual
def step_bookmark_relation_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark relation delete -y '
             '--bookmark-id "{myBookmark}" '
             '--relation-name "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Bookmarks/put/Creates or updates a bookmark.
@try_manual
def step_bookmark_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark create '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--created "2021-09-01T13:15:30Z" '
             '--user-info-object-id "2046feea-040d-4a46-9e2b-91c2941bfa70" '
             '--display-name "My bookmark" '
             '--entity-mappings "[{{\\"entityType\\":\\"Account\\",\\"fieldMappings\\":[{{\\"identifier\\":\\"Fullname'
             '\\",\\"value\\":\\"johndoe@microsoft.com\\"}}]}}]" '
             '--labels "Tag1" "Tag2" '
             '--notes "Found a suspicious activity" '
             '--query "SecurityEvent | where TimeGenerated > ago(1d) and TimeGenerated < ago(2d)" '
             '--query-result "Security Event query result" '
             '--tactics "Execution" '
             '--techniques "T1609" '
             '--updated "2021-09-01T13:15:30Z" '
             '--object-id "2046feea-040d-4a46-9e2b-91c2941bfa70" '
             '--bookmark-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Bookmarks/get/Get a bookmark.
@try_manual
def step_bookmark_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark show '
             '--bookmark-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Bookmarks/get/Get all bookmarks.
@try_manual
def step_bookmark_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Bookmarks/delete/Delete a bookmark.
@try_manual
def step_bookmark_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel bookmark delete -y '
             '--bookmark-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/put/Creates or updates a APIPolling data connector
@try_manual
def step_data_connector_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector create '
             '--data-connector "{{\\"kind\\":\\"APIPolling\\",\\"properties\\":{{\\"connectorUiConfig\\":{{\\"availabil'
             'ity\\":{{\\"isPreview\\":true,\\"status\\":1}},\\"connectivityCriteria\\":[{{\\"type\\":\\"SentinelKindsV'
             '2\\",\\"value\\":[]}}],\\"dataTypes\\":[{{\\"name\\":\\"{{{{{{{{graphQueriesTableName}}}}}}}}\\",\\"lastD'
             'ataReceivedQuery\\":\\"{{{{{{{{graphQueriesTableName}}}}}}}}\\\\n            | summarize Time = '
             'max(TimeGenerated)\\\\n            | where isnotempty(Time)\\"}}],\\"descriptionMarkdown\\":\\"The '
             'GitHub audit log connector provides the capability to ingest GitHub logs into Azure Sentinel. By '
             'connecting GitHub audit logs into Azure Sentinel, you can view this data in workbooks, use it to create '
             'custom alerts, and improve your investigation process.\\",\\"graphQueries\\":[{{\\"baseQuery\\":\\"{{{{{{'
             '{{graphQueriesTableName}}}}}}}}\\",\\"legend\\":\\"GitHub audit log events\\",\\"metricName\\":\\"Total '
             'events received\\"}}],\\"graphQueriesTableName\\":\\"GitHubAuditLogPolling_CL\\",\\"instructionSteps\\":['
             '{{\\"description\\":\\"Enable GitHub audit Logs. \\\\n Follow [this](https://docs.github.com/en/github/au'
             'thenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token) to create '
             'or find your personal key\\",\\"instructions\\":[{{\\"type\\":\\"APIKey\\",\\"parameters\\":{{\\"enable\\'
             '":\\"true\\",\\"userRequestPlaceHoldersInput\\":[{{\\"displayText\\":\\"Organization '
             'Name\\",\\"placeHolderName\\":\\"{{{{{{{{placeHolder1}}}}}}}}\\",\\"placeHolderValue\\":\\"\\",\\"request'
             'ObjectKey\\":\\"apiEndpoint\\"}}]}}}}],\\"title\\":\\"Connect GitHub Enterprise Audit Log to Azure '
             'Sentinel\\"}}],\\"permissions\\":{{\\"customs\\":[{{\\"name\\":\\"GitHub API personal token '
             'Key\\",\\"description\\":\\"You need access to GitHub personal token, the key should have \'admin:org\' '
             'scope\\"}}],\\"resourceProvider\\":[{{\\"permissionsDisplayText\\":\\"read and write permissions are '
             'required.\\",\\"provider\\":\\"Microsoft.OperationalInsights/workspaces\\",\\"providerDisplayName\\":\\"W'
             'orkspace\\",\\"requiredPermissions\\":{{\\"delete\\":true,\\"read\\":true,\\"write\\":true}},\\"scope\\":'
             '\\"Workspace\\"}}]}},\\"publisher\\":\\"GitHub\\",\\"sampleQueries\\":[{{\\"description\\":\\"All '
             'logs\\",\\"query\\":\\"{{{{{{{{graphQueriesTableName}}}}}}}}\\\\n | take 10 '
             '<change>\\"}}],\\"title\\":\\"GitHub Enterprise Audit Log\\"}},\\"pollingConfig\\":{{\\"auth\\":{{\\"apiK'
             'eyIdentifier\\":\\"token\\",\\"apiKeyName\\":\\"Authorization\\",\\"authType\\":\\"APIKey\\"}},\\"paging'
             '\\":{{\\"pageSizeParaName\\":\\"per_page\\",\\"pagingType\\":\\"LinkHeader\\"}},\\"response\\":{{\\"event'
             'sJsonPaths\\":[\\"$\\"]}},\\"request\\":{{\\"apiEndpoint\\":\\"https://api.github.com/organizations/{{{{{'
             '{{{placeHolder1}}}}}}}}/audit-log\\",\\"headers\\":{{\\"Accept\\":\\"application/json\\",\\"User-Agent\\"'
             ':\\"Scuba\\"}},\\"httpMethod\\":\\"Get\\",\\"queryParameters\\":{{\\"phrase\\":\\"created:{{{{_QueryWindo'
             'wStartTime}}}}..{{{{_QueryWindowEndTime}}}}\\"}},\\"queryTimeFormat\\":\\"yyyy-MM-ddTHH:mm:ssZ\\",\\"quer'
             'yWindowInMin\\":15,\\"rateLimitQps\\":50,\\"retryCount\\":2,\\"timeoutInSeconds\\":60}}}}}}}}" '
             '--data-connector-id "316ec55e-7138-4d63-ab18-90c8a60fd1c8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/put/Creates or updates a Dynamics365 data connector.
@try_manual
def step_data_connector_create2(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector create '
             '--data-connector "{{\\"etag\\":\\"\\\\\\"0300bf09-0000-0000-0000-5c37296e0000\\\\\\"\\",\\"kind\\":\\"Dyn'
             'amics365\\",\\"properties\\":{{\\"dataTypes\\":{{\\"dynamics365CdsActivities\\":{{\\"state\\":\\"Enabled'
             '\\"}}}},\\"tenantId\\":\\"2070ecc9-b4d5-4ae4-adaa-936fa1954fa8\\"}}}}" '
             '--data-connector-id "c2541efb-c9a6-47fe-9501-87d1017d1512" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/put/Creates or updates a GenericUI data connector
@try_manual
def step_data_connector_create3(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector create '
             '--data-connector "{{\\"kind\\":\\"GenericUI\\",\\"properties\\":{{\\"connectorUiConfig\\":{{\\"availabili'
             'ty\\":{{\\"isPreview\\":true,\\"status\\":1}},\\"connectivityCriteria\\":[{{\\"type\\":\\"IsConnectedQuer'
             'y\\",\\"value\\":[\\"{{{{{{{{graphQueriesTableName}}}}}}}}\\\\n            | summarize LastLogReceived = '
             'max(TimeGenerated)\\\\n            | project IsConnected = LastLogReceived > '
             'ago(30d)\\"]}}],\\"dataTypes\\":[{{\\"name\\":\\"{{{{{{{{graphQueriesTableName}}}}}}}}\\",\\"lastDataRece'
             'ivedQuery\\":\\"{{{{{{{{graphQueriesTableName}}}}}}}}\\\\n            | summarize Time = '
             'max(TimeGenerated)\\\\n            | where isnotempty(Time)\\"}}],\\"descriptionMarkdown\\":\\"The '
             '[Qualys Vulnerability Management (VM)](https://www.qualys.com/apps/vulnerability-management/) data '
             'connector provides the capability to ingest vulnerability host detection data into Azure Sentinel '
             'through the Qualys API. The connector provides visibility into host detection data from vulerability '
             'scans. This connector provides Azure Sentinel the capability to view dashboards, create custom alerts, '
             'and improve investigation \\",\\"graphQueries\\":[{{\\"baseQuery\\":\\"{{{{{{{{graphQueriesTableName}}}}}'
             '}}}\\",\\"legend\\":\\"{{{{{{{{graphQueriesTableName}}}}}}}}\\",\\"metricName\\":\\"Total data '
             'received\\"}}],\\"graphQueriesTableName\\":\\"QualysHostDetection_CL\\",\\"instructionSteps\\":[{{\\"desc'
             'ription\\":\\">**NOTE:** This connector uses Azure Functions to connect to Qualys VM to pull its logs '
             'into Azure Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions '
             'pricing page](https://azure.microsoft.com/pricing/details/functions/) for details.\\",\\"title\\":\\"\\"}'
             '},{{\\"description\\":\\">**(Optional Step)** Securely store workspace and API authorization key(s) or '
             'token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key '
             'values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-re'
             'ferences) to use Azure Key Vault with an Azure Function App.\\",\\"title\\":\\"\\"}},{{\\"description\\":'
             '\\"**STEP 1 - Configuration steps for the Qualys VM API**\\\\n\\\\n1. Log into the Qualys Vulnerability '
             'Management console with an administrator account, select the **Users** tab and the **Users** subtab. '
             '\\\\n2. Click on the **New** drop-down menu and select **Users..**\\\\n3. Create a username and password '
             'for the API account. \\\\n4. In the **User Roles** tab, ensure the account role is set to **Manager** '
             'and access is allowed to **GUI** and **API**\\\\n4. Log out of the administrator account and log into '
             'the console with the new API credentials for validation, then log out of the API account. \\\\n5. Log '
             'back into the console using an administrator account and modify the API accounts User Roles, removing '
             'access to **GUI**. \\\\n6. Save all changes.\\",\\"title\\":\\"\\"}},{{\\"description\\":\\"**STEP 2 - '
             'Choose ONE from the following two deployment options to deploy the connector and the associated Azure '
             'Function**\\\\n\\\\n>**IMPORTANT:** Before deploying the Qualys VM connector, have the Workspace ID and '
             'Workspace Primary Key (can be copied from the following), as well as the Qualys VM API Authorization '
             'Key(s), readily available.\\",\\"instructions\\":[{{\\"type\\":\\"CopyableLabel\\",\\"parameters\\":{{\\"'
             'fillWith\\":[\\"WorkspaceId\\"],\\"label\\":\\"Workspace ID\\"}}}},{{\\"type\\":\\"CopyableLabel\\",\\"pa'
             'rameters\\":{{\\"fillWith\\":[\\"PrimaryKey\\"],\\"label\\":\\"Primary Key\\"}}}}],\\"title\\":\\"\\"}},{'
             '{\\"description\\":\\"Use this method for automated deployment of the Qualys VM connector using an ARM '
             'Tempate.\\\\n\\\\n1. Click the **Deploy to Azure** button below. \\\\n\\\\n\\\\t[![Deploy To '
             'Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinelqualysvmazuredeploy)\\\\n2. Select '
             'the preferred **Subscription**, **Resource Group** and **Location**. \\\\n3. Enter the **Workspace ID**, '
             '**Workspace Key**, **API Username**, **API Password** , update the **URI**, and any additional URI '
             '**Filter Parameters** (each filter should be separated by an \\\\\\"&\\\\\\" symbol, no spaces.) \\\\n> '
             '- Enter the URI that corresponds to your region. The complete list of API Server URLs can be [found '
             'here](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf#G4.735348) -- There is no need to add a '
             'time suffix to the URI, the Function App will dynamically append the Time Value to the URI in the proper '
             'format. \\\\n - The default **Time Interval** is set to pull the last five (5) minutes of data. If the '
             'time interval needs to be modified, it is recommended to change the Function App Timer Trigger '
             'accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion. \\\\n> - '
             'Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri'
             '={{{{Security Identifier}}}})`schema in place of the string values. Refer to [Key Vault references '
             'documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for '
             'further details. \\\\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. '
             '\\\\n5. Click **Purchase** to deploy.\\",\\"title\\":\\"Option 1 - Azure Resource Manager (ARM) '
             'Template\\"}},{{\\"description\\":\\"Use the following step-by-step instructions to deploy the Quayls VM '
             'connector manually with Azure Functions.\\",\\"title\\":\\"Option 2 - Manual Deployment of Azure '
             'Functions\\"}},{{\\"description\\":\\"**1. Create a Function App**\\\\n\\\\n1.  From the Azure Portal, '
             'navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Micr'
             'osoft.Web%2Fsites/kind/functionapp), and select **+ Add**.\\\\n2. In the **Basics** tab, ensure Runtime '
             'stack is set to **Powershell Core**. \\\\n3. In the **Hosting** tab, ensure the **Consumption '
             '(Serverless)** plan type is selected.\\\\n4. Make other preferrable configuration changes, if needed, '
             'then click **Create**.\\",\\"title\\":\\"\\"}},{{\\"description\\":\\"**2. Import Function App '
             'Code**\\\\n\\\\n1. In the newly created Function App, select **Functions** on the left pane and click '
             '**+ New Function**.\\\\n2. Select **Timer Trigger**.\\\\n3. Enter a unique Function **Name** and leave '
             'the default cron schedule of every 5 minutes, then click **Create**.\\\\n5. Click on **Code + Test** on '
             'the left pane. \\\\n6. Copy the [Function App Code](https://aka.ms/sentinelqualysvmazurefunctioncode) '
             'and paste into the Function App `run.ps1` editor.\\\\n7. Click **Save**.\\",\\"title\\":\\"\\"}},{{\\"des'
             'cription\\":\\"**3. Configure the Function App**\\\\n\\\\n1. In the Function App, select the Function '
             'App Name and select **Configuration**.\\\\n2. In the **Application settings** tab, select **+ New '
             'application setting**.\\\\n3. Add each of the following seven (7) application settings individually, '
             'with their respective string values (case-sensitive): \\\\n\\\\t\\\\tapiUsername\\\\n\\\\t\\\\tapiPasswor'
             'd\\\\n\\\\t\\\\tworkspaceID\\\\n\\\\t\\\\tworkspaceKey\\\\n\\\\t\\\\turi\\\\n\\\\t\\\\tfilterParameters\\'
             '\\n\\\\t\\\\ttimeInterval\\\\n> - Enter the URI that corresponds to your region. The complete list of '
             'API Server URLs can be [found here](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf#G4.735348)'
             '. The `uri` value must follow the following schema: `https://<API Server>/api/2.0/fo/asset/host/vm/detect'
             'ion/?action=list&vm_processed_after=` -- There is no need to add a time suffix to the URI, the Function '
             'App will dynamically append the Time Value to the URI in the proper format.\\\\n> - Add any additional '
             'filter parameters, for the `filterParameters` variable, that need to be appended to the URI. Each '
             'parameter should be seperated by an \\\\\\"&\\\\\\" symbol and should not include any spaces.\\\\n> - '
             'Set the `timeInterval` (in minutes) to the value of `5` to correspond to the Timer Trigger of every `5` '
             'minutes. If the time interval needs to be modified, it is recommended to change the Function App Timer '
             'Trigger accordingly to prevent overlapping data ingestion.\\\\n> - Note: If using Azure Key Vault, use '
             'the`@Microsoft.KeyVault(SecretUri={{{{Security Identifier}}}})`schema in place of the string values. '
             'Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-ke'
             'y-vault-references) for further details.\\\\n4. Once all application settings have been entered, click '
             '**Save**.\\",\\"title\\":\\"\\"}},{{\\"description\\":\\"**4. Configure the host.json**.\\\\n\\\\nDue to '
             'the potentially large amount of Qualys host detection data being ingested, it can cause the execution '
             'time to surpass the default Function App timeout of five (5) minutes. Increase the default timeout '
             'duration to the maximum of ten (10) minutes, under the Consumption Plan, to allow more time for the '
             'Function App to execute.\\\\n\\\\n1. In the Function App, select the Function App Name and select the '
             '**App Service Editor** blade.\\\\n2. Click **Go** to open the editor, then select the **host.json** file '
             'under the **wwwroot** directory.\\\\n3. Add the line `\\\\\\"functionTimeout\\\\\\": '
             '\\\\\\"00:10:00\\\\\\",` above the `managedDependancy` line \\\\n4. Ensure **SAVED** appears on the top '
             'right corner of the editor, then exit the editor.\\\\n\\\\n> NOTE: If a longer timeout duration is '
             'required, consider upgrading to an [App Service Plan](https://docs.microsoft.com/azure/azure-functions/fu'
             'nctions-scale#timeout)\\",\\"title\\":\\"\\"}}],\\"permissions\\":{{\\"customs\\":[{{\\"name\\":\\"Micros'
             'oft.Web/sites permissions\\",\\"description\\":\\"Read and write permissions to Azure Functions to '
             'create a Function App is required. [See the documentation to learn more about Azure '
             'Functions](https://docs.microsoft.com/azure/azure-functions/).\\"}},{{\\"name\\":\\"Qualys API '
             'Key\\",\\"description\\":\\"A Qualys VM API username and password is required. [See the documentation to '
             'learn more about Qualys VM API](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf).\\"}}],\\"res'
             'ourceProvider\\":[{{\\"permissionsDisplayText\\":\\"read and write permissions on the workspace are '
             'required.\\",\\"provider\\":\\"Microsoft.OperationalInsights/workspaces\\",\\"providerDisplayName\\":\\"W'
             'orkspace\\",\\"requiredPermissions\\":{{\\"delete\\":true,\\"read\\":true,\\"write\\":true}},\\"scope\\":'
             '\\"Workspace\\"}},{{\\"permissionsDisplayText\\":\\"read permissions to shared keys for the workspace '
             'are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure'
             '/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).\\",\\"provider\\":\\"Microsoft.Operat'
             'ionalInsights/workspaces/sharedKeys\\",\\"providerDisplayName\\":\\"Keys\\",\\"requiredPermissions\\":{{'
             '\\"action\\":true}},\\"scope\\":\\"Workspace\\"}}]}},\\"publisher\\":\\"Qualys\\",\\"sampleQueries\\":[{{'
             '\\"description\\":\\"Top 10 Vulerabilities detected\\",\\"query\\":\\"{{{{{{{{graphQueriesTableName}}}}}}'
             '}}\\\\n | mv-expand todynamic(Detections_s)\\\\n | extend Vulnerability = '
             'tostring(Detections_s.Results)\\\\n | summarize count() by Vulnerability\\\\n | top 10 by '
             'count_\\"}}],\\"title\\":\\"Qualys Vulnerability Management (CCP DEMO)\\"}}}}}}" '
             '--data-connector-id "316ec55e-7138-4d63-ab18-90c8a60fd1c8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/put/Creates or updates a Threat Intelligence Taxii data connector.
@try_manual
def step_data_connector_create4(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector create '
             '--data-connector "{{\\"etag\\":\\"d12423f6-a60b-4ca5-88c0-feb1a182d0f0\\",\\"kind\\":\\"ThreatIntelligenc'
             'eTaxii\\",\\"properties\\":{{\\"collectionId\\":\\"135\\",\\"dataTypes\\":{{\\"taxiiClient\\":{{\\"state'
             '\\":\\"Enabled\\"}}}},\\"friendlyName\\":\\"testTaxii\\",\\"password\\":\\"--\\",\\"pollingFrequency\\":'
             '\\"OnceADay\\",\\"taxiiLookbackPeriod\\":\\"2020-01-01T13:00:30.123Z\\",\\"taxiiServer\\":\\"https://limo'
             '.anomali.com/api/v1/taxii2/feeds\\",\\"tenantId\\":\\"06b3ccb8-1384-4bcc-aec7-852f6d57161b\\",\\"userName'
             '\\":\\"--\\",\\"workspaceId\\":\\"dd124572-4962-4495-9bd2-9dade12314b4\\"}}}}" '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/put/Creates or updates an Office PowerBI data connector
@try_manual
def step_data_connector_create5(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector create '
             '--data-connector "{{\\"etag\\":\\"\\\\\\"0300bf09-0000-0000-0000-5c37296e0000\\\\\\"\\",\\"kind\\":\\"Off'
             'icePowerBI\\",\\"properties\\":{{\\"dataTypes\\":{{\\"logs\\":{{\\"state\\":\\"Enabled\\"}}}},\\"tenantId'
             '\\":\\"2070ecc9-b4d5-4ae4-adaa-936fa1954fa8\\"}}}}" '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/put/Creates or updates an Office365 data connector
@try_manual
def step_data_connector_create6(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector create '
             '--data-connector "{{\\"etag\\":\\"\\\\\\"0300bf09-0000-0000-0000-5c37296e0000\\\\\\"\\",\\"kind\\":\\"Off'
             'ice365\\",\\"properties\\":{{\\"dataTypes\\":{{\\"exchange\\":{{\\"state\\":\\"Enabled\\"}},\\"sharePoint'
             '\\":{{\\"state\\":\\"Enabled\\"}},\\"teams\\":{{\\"state\\":\\"Enabled\\"}}}},\\"tenantId\\":\\"2070ecc9-'
             'b4d5-4ae4-adaa-936fa1954fa8\\"}}}}" '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/put/Creates or updates an Office365 Project data connector
@try_manual
def step_data_connector_create7(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector create '
             '--data-connector "{{\\"etag\\":\\"\\\\\\"0300bf09-0000-0000-0000-5c37296e0000\\\\\\"\\",\\"kind\\":\\"Off'
             'ice365Project\\",\\"properties\\":{{\\"dataTypes\\":{{\\"logs\\":{{\\"state\\":\\"Enabled\\"}}}},\\"tenan'
             'tId\\":\\"2070ecc9-b4d5-4ae4-adaa-936fa1954fa8\\"}}}}" '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/put/Creates or updates an Threat Intelligence Platform data connector
@try_manual
def step_data_connector_create8(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector create '
             '--data-connector "{{\\"kind\\":\\"ThreatIntelligence\\",\\"properties\\":{{\\"dataTypes\\":{{\\"indicator'
             's\\":{{\\"state\\":\\"Enabled\\"}}}},\\"tenantId\\":\\"06b3ccb8-1384-4bcc-aec7-852f6d57161b\\",\\"tipLook'
             'backPeriod\\":\\"2020-01-01T13:00:30.123Z\\"}}}}" '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get a APIPolling data connector
@try_manual
def step_data_connector_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "316ec55e-7138-4d63-ab18-90c8a60fd1c8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get a ASC data connector
@try_manual
def step_data_connector_show2(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "763f9fa1-c2d3-4fa2-93e9-bccd4899aa12" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get a Dynamics365 data connector
@try_manual
def step_data_connector_show3(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "c2541efb-c9a6-47fe-9501-87d1017d1512" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get a GenericUI data connector
@try_manual
def step_data_connector_show4(test, checks=None):
    return step_data_connector_show(test, checks)


# EXAMPLE: /DataConnectors/get/Get a IoT data connector
@try_manual
def step_data_connector_show5(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "d2e5dc7a-f3a2-429d-954b-939fa8c2932e" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get a MCAS data connector
@try_manual
def step_data_connector_show6(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "b96d014d-b5c2-4a01-9aba-a8058f629d42" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get a MDATP data connector
@try_manual
def step_data_connector_show7(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "06b3ccb8-1384-4bcc-aec7-852f6d57161b" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get a MicrosoftThreatIntelligence data connector
@try_manual
def step_data_connector_show8(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "c345bf40-8509-4ed2-b947-50cb773aaf04" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get a MicrosoftThreatProtection data connector
@try_manual
def step_data_connector_show9(test, checks=None):
    return step_data_connector_show8(test, checks)


# EXAMPLE: /DataConnectors/get/Get a TI data connector
@try_manual
def step_data_connector_show10(test, checks=None):
    return step_data_connector_show8(test, checks)


# EXAMPLE: /DataConnectors/get/Get a TI Taxii data connector.
@try_manual
def step_data_connector_show11(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "c39bb458-02a7-4b3f-b0c8-71a1d2692652" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get all data connectors.
@try_manual
def step_data_connector_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get an AAD data connector
@try_manual
def step_data_connector_show12(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "f0cd27d2-5f03-4c06-ba31-d2dc82dcb51d" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get an AATP data connector
@try_manual
def step_data_connector_show13(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "07e42cb3-e658-4e90-801c-efa0f29d3d44" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get an Aws S3 data connector
@try_manual
def step_data_connector_show14(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "afef3743-0c88-469c-84ff-ca2e87dc1e48" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get an AwsCloudTrail data connector
@try_manual
def step_data_connector_show15(test, checks=None):
    return step_data_connector_show8(test, checks)


# EXAMPLE: /DataConnectors/get/Get an Office ATP data connector
@try_manual
def step_data_connector_show16(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "3d3e955e-33eb-401d-89a7-251c81ddd660" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get an Office IRM data connector
@try_manual
def step_data_connector_show17(test, checks=None):
    return step_data_connector_show16(test, checks)


# EXAMPLE: /DataConnectors/get/Get an Office365 data connector.
@try_manual
def step_data_connector_show18(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/get/Get an Office365 PowerBI data connector
@try_manual
def step_data_connector_show19(test, checks=None):
    return step_data_connector_show18(test, checks)


# EXAMPLE: /DataConnectors/get/Get an Office365 Project data connector
@try_manual
def step_data_connector_show20(test, checks=None):
    return step_data_connector_show18(test, checks)


# EXAMPLE: /DataConnectors/post/Connect an APIPolling data connector
@try_manual
def step_data_connector_connect(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector connect '
             '--api-key "123456789" '
             '--kind "APIKey" '
             '--request-config-user-input-values "[{{\\"displayText\\":\\"Organization Name\\",\\"placeHolderName\\":\\'
             '"{{{{{{{{placeHolder1}}}}}}}}\\",\\"placeHolderValue\\":\\"somePlaceHolderValue\\",\\"requestObjectKey\\"'
             ':\\"apiEndpoint\\"}}]" '
             '--data-connector-id "316ec55e-7138-4d63-ab18-90c8a60fd1c8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/post/Connect an APIPolling V2 logs data connector
@try_manual
def step_data_connector_connect2(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector connect '
             '--api-key "123456789" '
             '--data-collection-endpoint "https://test.eastus.ingest.monitor.azure.com" '
             '--data-collection-rule-immutable-id "dcr-34adsj9o7d6f9de204478b9cgb43b631" '
             '--kind "APIKey" '
             '--output-stream "Custom-MyTableRawData" '
             '--request-config-user-input-values "[{{\\"displayText\\":\\"Organization Name\\",\\"placeHolderName\\":\\'
             '"{{{{{{{{placeHolder1}}}}}}}}\\",\\"placeHolderValue\\":\\"somePlaceHolderValue\\",\\"requestObjectKey\\"'
             ':\\"apiEndpoint\\"}}]" '
             '--data-connector-id "316ec55e-7138-4d63-ab18-90c8a60fd1c8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/post/Disconnect an APIPolling data connector
@try_manual
def step_data_connector_disconnect(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector disconnect '
             '--data-connector-id "316ec55e-7138-4d63-ab18-90c8a60fd1c8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/delete/Delete a APIPolling data connector
@try_manual
def step_data_connector_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector delete -y '
             '--data-connector-id "316ec55e-7138-4d63-ab18-90c8a60fd1c8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/delete/Delete a GenericUI data connector
@try_manual
def step_data_connector_delete2(test, checks=None):
    return step_data_connector_delete(test, checks)


# EXAMPLE: /DataConnectors/delete/Delete an Office PowerBI data connector
@try_manual
def step_data_connector_delete3(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector delete -y '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectors/delete/Delete an Office365 data connector
@try_manual
def step_data_connector_delete4(test, checks=None):
    return step_data_connector_delete3(test, checks)


# EXAMPLE: /DataConnectors/delete/Delete an Office365 Project data connector
@try_manual
def step_data_connector_delete5(test, checks=None):
    return step_data_connector_delete3(test, checks)


# EXAMPLE: /DataConnectorsCheckRequirements/post/Check requirements for AAD - no authorization.
@try_manual
def step_data_connector_check_requirement_post(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel data-connector check-requirement post '
             '--aad-check-requirements tenant-id="2070ecc9-b4d5-4ae4-adaa-936fa1954fa8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /DataConnectorsCheckRequirements/post/Check requirements for AAD - no license.
@try_manual
def step_data_connector_check_requirement_post2(test, checks=None):
    return step_data_connector_check_requirement_post(test, checks)


# EXAMPLE: /DataConnectorsCheckRequirements/post/Check requirements for AAD.
@try_manual
def step_data_connector_check_requirement_post3(test, checks=None):
    return step_data_connector_check_requirement_post(test, checks)


# EXAMPLE: /DomainWhois/get/Get whois information for a single domain name
@try_manual
def step_domain_whois_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel domain-whois show '
             '--domain "microsoft.com" '
             '--resource-group "{rg}"',
             checks=checks)


# EXAMPLE: /Entities/get/Get a cloud application entity.
@try_manual
def step_entity_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity show '
             '--entity-id "e1d3d618-e11f-478b-98e3-bb381539a8e1" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/get/Get a dns entity.
@try_manual
def step_entity_show2(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity show '
             '--entity-id "f4e74920-f2c0-4412-a45f-66d94fdf01f8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/get/Get a file entity.
@try_manual
def step_entity_show3(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity show '
             '--entity-id "af378b21-b4aa-4fe7-bc70-13f8621a322f" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/get/Get a file hash entity.
@try_manual
def step_entity_show4(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity show '
             '--entity-id "ea359fa6-c1e5-f878-e105-6344f3e399a1" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/get/Get a host entity.
@try_manual
def step_entity_show5(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get a mailbox entity.
@try_manual
def step_entity_show6(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get a mailCluster entity.
@try_manual
def step_entity_show7(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get a mailMessage entity.
@try_manual
def step_entity_show8(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get a malware entity.
@try_manual
def step_entity_show9(test, checks=None):
    return step_entity_show3(test, checks)


# EXAMPLE: /Entities/get/Get a process entity.
@try_manual
def step_entity_show10(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity show '
             '--entity-id "7264685c-038c-42c6-948c-38e14ef1fb98" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/get/Get a registry key entity.
@try_manual
def step_entity_show11(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get a registry value entity.
@try_manual
def step_entity_show12(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity show '
             '--entity-id "dc44bd11-b348-4d76-ad29-37bf7aa41356" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/get/Get a security alert entity.
@try_manual
def step_entity_show13(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity show '
             '--entity-id "4aa486e0-6f85-41af-99ea-7acdce7be6c8" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/get/Get a security group entity.
@try_manual
def step_entity_show14(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get a submissionMail entity.
@try_manual
def step_entity_show15(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get a url entity.
@try_manual
def step_entity_show16(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get all entities.
@try_manual
def step_entity_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/get/Get an account entity.
@try_manual
def step_entity_show17(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get an azure resource entity.
@try_manual
def step_entity_show18(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get an IoT device entity.
@try_manual
def step_entity_show19(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get an ip entity.
@try_manual
def step_entity_show20(test, checks=None):
    return step_entity_show(test, checks)


# EXAMPLE: /Entities/get/Get Entity Query
@try_manual
def step_entity_query(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity query '
             '--entity-id "e1d3d618-e11f-478b-98e3-bb381539a8e1" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/post/Entity Insight
@try_manual
def step_entity_get_insight(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity get-insight '
             '--entity-id "e1d3d618-e11f-478b-98e3-bb381539a8e1" '
             '--add-default-extended-time-range false '
             '--end-time "2021-10-01T00:00:00.000Z" '
             '--insight-query-ids "cae8d0aa-aa45-4d53-8d88-17dd64ffd4e4" '
             '--start-time "2021-09-01T00:00:00.000Z" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Entities/post/Expand an entity
@try_manual
def step_entity_expand(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity expand '
             '--entity-id "e1d3d618-e11f-478b-98e3-bb381539a8e1" '
             '--end-time "2019-05-26T00:00:00.000Z" '
             '--expansion-id "a77992f3-25e9-4d01-99a4-5ff606cc410a" '
             '--start-time "2019-04-25T00:00:00.000Z" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntitiesGetTimeline/post/Entity timeline
@try_manual
def step_entity_get_timeline_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity get-timeline list '
             '--entity-id "e1d3d618-e11f-478b-98e3-bb381539a8e1" '
             '--end-time "2021-10-01T00:00:00.000Z" '
             '--number-of-bucket 4 '
             '--start-time "2021-09-01T00:00:00.000Z" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntitiesRelations/get/Get all relations of an entity.
@try_manual
def step_entity_relation_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity relation list '
             '--entity-id "{myIncident}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntityQueries/put/Creates or updates an Activity entity query.
@try_manual
def step_entity_query_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity query create '
             '--entity-query "{{\\"etag\\":\\"\\\\\\"0300bf09-0000-0000-0000-5c37296e0000\\\\\\"\\",\\"kind\\":\\"Activ'
             'ity\\",\\"properties\\":{{\\"description\\":\\"Account deleted on host\\",\\"content\\":\\"On '
             '\'{{{{{{{{Computer}}}}}}}}\' the account \'{{{{{{{{TargetAccount}}}}}}}}\' was deleted by '
             '\'{{{{{{{{AddedBy}}}}}}}}\'\\",\\"enabled\\":true,\\"entitiesFilter\\":{{\\"Host_OsFamily\\":[\\"Windows'
             '\\"]}},\\"inputEntityType\\":\\"Host\\",\\"queryDefinitions\\":{{\\"query\\":\\"let GetAccountActions = '
             '(v_Host_Name:string, v_Host_NTDomain:string, v_Host_DnsDomain:string, v_Host_AzureID:string, '
             'v_Host_OMSAgentID:string){{{{\\\\nSecurityEvent\\\\n| where EventID in (4725, 4726, 4767, 4720, 4722, '
             '4723, 4724)\\\\n// parsing for Host to handle variety of conventions coming from data\\\\n| extend '
             'Host_HostName = case(\\\\nComputer has \'@\', tostring(split(Computer, \'@\')[0]),\\\\nComputer has '
             '\'\\\\\\\\\\\\\\\\\', tostring(split(Computer, \'\\\\\\\\\\\\\\\\\')[1]),\\\\nComputer has \'.\', '
             'tostring(split(Computer, \'.\')[0]),\\\\nComputer\\\\n)\\\\n| extend Host_NTDomain = case(\\\\nComputer '
             'has \'\\\\\\\\\\\\\\\\\', tostring(split(Computer, \'\\\\\\\\\\\\\\\\\')[0]), \\\\nComputer has \'.\', '
             'tostring(split(Computer, \'.\')[-2]), \\\\nComputer\\\\n)\\\\n| extend Host_DnsDomain = '
             'case(\\\\nComputer has \'\\\\\\\\\\\\\\\\\', tostring(split(Computer, \'\\\\\\\\\\\\\\\\\')[0]), '
             '\\\\nComputer has \'.\', strcat_array(array_slice(split(Computer,\'.\'),-2,-1),\'.\'), '
             '\\\\nComputer\\\\n)\\\\n| where (Host_HostName =~ v_Host_Name and Host_NTDomain =~ v_Host_NTDomain) '
             '\\\\nor (Host_HostName =~ v_Host_Name and Host_DnsDomain =~ v_Host_DnsDomain) \\\\nor v_Host_AzureID =~ '
             '_ResourceId \\\\nor v_Host_OMSAgentID == SourceComputerId\\\\n| project TimeGenerated, EventID, '
             'Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid, SubjectUserName, '
             'SubjectUserSid, _ResourceId, SourceComputerId\\\\n| extend AddedBy = SubjectUserName\\\\n// Future '
             'support for Activities\\\\n| extend timestamp = TimeGenerated, HostCustomEntity = Computer, '
             'AccountCustomEntity = TargetAccount\\\\n}}}};\\\\nGetAccountActions(\'{{{{{{{{Host_HostName}}}}}}}}\', '
             '\'{{{{{{{{Host_NTDomain}}}}}}}}\', \'{{{{{{{{Host_DnsDomain}}}}}}}}\', \'{{{{{{{{Host_AzureID}}}}}}}}\', '
             '\'{{{{{{{{Host_OMSAgentID}}}}}}}}\')\\\\n \\\\n| where EventID == 4726 \\"}},\\"requiredInputFieldsSets\\'
             '":[[\\"Host_HostName\\",\\"Host_NTDomain\\"],[\\"Host_HostName\\",\\"Host_DnsDomain\\"],[\\"Host_AzureID'
             '\\"],[\\"Host_OMSAgentID\\"]],\\"templateName\\":null,\\"title\\":\\"An account was deleted on this '
             'host\\"}}}}" '
             '--entity-query-id "07da3cc8-c8ad-4710-a44e-334cdcb7882b" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntityQueries/get/Get all entity queries.
@try_manual
def step_entity_query_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity query list '
             '--kind "Expansion" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntityQueries/get/Get an Activity entity query.
@try_manual
def step_entity_query_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity query show '
             '--entity-query-id "07da3cc8-c8ad-4710-a44e-334cdcb7882b" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntityQueries/get/Get an Expansion entity query.
@try_manual
def step_entity_query_show2(test, checks=None):
    return step_entity_query_show(test, checks)


# EXAMPLE: /EntityQueries/delete/Delete an entity query.
@try_manual
def step_entity_query_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity query delete -y '
             '--entity-query-id "07da3cc8-c8ad-4710-a44e-334cdcb7882b" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntityQueryTemplates/get/Get all entity query templates.
@try_manual
def step_entity_query_template_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity query-template list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntityQueryTemplates/get/Get an Activity entity query template.
@try_manual
def step_entity_query_template_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity query-template show '
             '--entity-query-template-id "07da3cc8-c8ad-4710-a44e-334cdcb7882b" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /EntityRelations/get/Get an entity relation.
@try_manual
def step_entity_relation_show_relation(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel entity relation show-relation '
             '--entity-id "{myIncident}" '
             '--relation-name "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IncidentComments/put/Creates or updates an incident comment.
@try_manual
def step_incident_comment_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident-comment create '
             '--message "Some message" '
             '--incident-comment-id "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--incident-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IncidentComments/get/Get all incident comments.
@try_manual
def step_incident_comment_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident-comment list '
             '--incident-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IncidentComments/get/Get an incident comment.
@try_manual
def step_incident_comment_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident-comment show '
             '--incident-comment-id "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--incident-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IncidentComments/delete/Delete the incident comment.
@try_manual
def step_incident_comment_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident-comment delete -y '
             '--incident-comment-id "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--incident-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IncidentRelations/put/Creates or updates an incident relation.
@try_manual
def step_incident_relation_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident relation create '
             '--incident-id "{myIncident}" '
             '--related-resource-id "/subscriptions/{subscription_id}/resourceGroups/{rg}/providers/Microsoft.Operation'
             'alIinsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/bookmarks/{myBookmark}" '
             '--relation-name "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IncidentRelations/get/Get all incident relations.
@try_manual
def step_incident_relation_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident relation list '
             '--incident-id "{myIncident}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IncidentRelations/get/Get an incident relation.
@try_manual
def step_incident_relation_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident relation show '
             '--incident-id "{myIncident}" '
             '--relation-name "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IncidentRelations/delete/Delete the incident relation.
@try_manual
def step_incident_relation_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident relation delete -y '
             '--incident-id "{myIncident}" '
             '--relation-name "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Incidents/put/Creates or updates an incident.
@try_manual
def step_incident_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident create '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--description "This is a demo incident" '
             '--classification "FalsePositive" '
             '--classification-comment "Not a malicious activity" '
             '--classification-reason "IncorrectAlertLogic" '
             '--first-activity-time-utc "2019-01-01T13:00:30Z" '
             '--last-activity-time-utc "2019-01-01T13:05:30Z" '
             '--owner object-id="2046feea-040d-4a46-9e2b-91c2941bfa70" '
             '--severity "High" '
             '--status "Closed" '
             '--title "My incident" '
             '--incident-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Incidents/get/Get all incidents.
@try_manual
def step_incident_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident list '
             '--orderby "properties/createdTimeUtc desc" '
             '--top 1 '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Incidents/get/Get an incident.
@try_manual
def step_incident_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident show '
             '--incident-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Incidents/post/Creates incident teams group.
@try_manual
def step_incident_create_team(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident create-team '
             '--incident-id "69a30280-6a4c-4aa7-9af0-5d63f335d600" '
             '--resource-group "{rg_2}" '
             '--team-description "Team description" '
             '--team-name "Team name" '
             '--workspace-name "AmbaE5WestCentralUS"',
             checks=checks)


# EXAMPLE: /Incidents/post/Get all incident alerts.
@try_manual
def step_incident_list_alert(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident list-alert '
             '--incident-id "{myIncident}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Incidents/post/Get all incident bookmarks.
@try_manual
def step_incident_list_bookmark(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident list-bookmark '
             '--incident-id "{myIncident}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Incidents/post/Gets all incident related entities
@try_manual
def step_incident_list_entity(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident list-entity '
             '--incident-id "{myIncident}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Incidents/post/Incidents_RunPlaybook
@try_manual
def step_incident_run_playbook(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident run-playbook '
             '--incident-identifier "73e01a99-5cd7-4139-a149-9f2736ff2ar4" '
             '--logic-apps-resource-id "/subscriptions/{subscription_id}/resourceGroups/{rg}/providers/Microsoft.Logic/'
             'workflows/my-playbook-name" '
             '--tenant-id "qwere6b2-9ac0-4464-9919-dccaee2e4ddd" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Incidents/delete/Delete an incident.
@try_manual
def step_incident_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel incident delete -y '
             '--incident-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /IPGeodata/get/Get geodata for a single IP address
@try_manual
def step_ip_geodata_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel ip-geodata show '
             '--ip-address "1.2.3.4" '
             '--resource-group "{rg}"',
             checks=checks)


# EXAMPLE: /Metadata/put/Create/update full metadata.
@try_manual
def step_metadata_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel metadata create '
             '--author name="User Name" email="email@microsoft.com" '
             '--categories domains="Application" domains="Security  Insider Threat" verticals="Healthcare" '
             '--content-id "c00ee137-7475-47c8-9cce-ec6f0f1bedd0" '
             '--content-schema-version "2.0" '
             '--custom-version "1.0" '
             '--dependencies "{{\\"criteria\\":[{{\\"criteria\\":[{{\\"name\\":\\"Microsoft Defender for '
             'Endpoint\\",\\"contentId\\":\\"045d06d0-ee72-4794-aba4-cf5646e4c756\\",\\"kind\\":\\"DataConnector\\"}},{'
             '{\\"contentId\\":\\"dbfcb2cc-d782-40ef-8d94-fe7af58a6f2d\\",\\"kind\\":\\"DataConnector\\"}},{{\\"content'
             'Id\\":\\"de4dca9b-eb37-47d6-a56f-b8b06b261593\\",\\"kind\\":\\"DataConnector\\",\\"version\\":\\"2.0\\"}}'
             '],\\"operator\\":\\"OR\\"}},{{\\"contentId\\":\\"31ee11cc-9989-4de8-b176-5e0ef5c4dbab\\",\\"kind\\":\\"Pl'
             'aybook\\",\\"version\\":\\"1.0\\"}},{{\\"contentId\\":\\"21ba424a-9438-4444-953a-7059539a7a1b\\",\\"kind'
             '\\":\\"Parser\\"}}],\\"operator\\":\\"AND\\"}}" '
             '--first-publish-date "2021-05-18" '
             '--kind "AnalyticsRule" '
             '--last-publish-date "2021-05-18" '
             '--parent-id "/subscriptions/{subscription_id}/resourceGroups/{rg}/providers/Microsoft.OperationalInsights'
             '/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRules/{myAlertRule}" '
             '--preview-images "firstImage.png" "secondImage.jpeg" '
             '--preview-images-dark "firstImageDark.png" "secondImageDark.jpeg" '
             '--providers "Amazon" "Microsoft" '
             '--source name="Contoso Solution 1.0" kind="Solution" source-id="b688a130-76f4-4a07-bf57-762222a3cadf" '
             '--support name="Microsoft" email="support@microsoft.com" link="https://support.microsoft.com/" '
             'tier="Partner" '
             '--threat-analysis-tactics "reconnaissance" "commandandcontrol" '
             '--threat-analysis-techniques "T1548" "T1548.001" '
             '--version "1.0.0.0" '
             '--name "{myMetadata}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Metadata/put/Create/update minimal metadata.
@try_manual
def step_metadata_create2(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel metadata create '
             '--content-id "c00ee137-7475-47c8-9cce-ec6f0f1bedd0" '
             '--kind "AnalyticsRule" '
             '--parent-id "/subscriptions/{subscription_id}/resourceGroups/{rg}/providers/Microsoft.OperationalInsights'
             '/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRules/{myAlertRule}" '
             '--name "{myMetadata}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Metadata/get/Get all metadata with OData filter/orderby/skip/top
@try_manual
def step_metadata_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel metadata list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Metadata/get/Get all metadata.
@try_manual
def step_metadata_list2(test, checks=None):
    return step_metadata_list(test, checks)


# EXAMPLE: /Metadata/get/Get single metadata by name
@try_manual
def step_metadata_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel metadata show '
             '--name "{myMetadata}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Metadata/patch/Update metadata.
@try_manual
def step_metadata_update(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel metadata update '
             '--name "{myMetadata}" '
             '--author name="User Name" email="email@microsoft.com" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Metadata/delete/Delete metadata.
@try_manual
def step_metadata_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel metadata delete -y '
             '--name "{myMetadata}" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /OfficeConsents/get/Get all office consents.
@try_manual
def step_office_consent_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel office-consent list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /OfficeConsents/get/Get an office consent.
@try_manual
def step_office_consent_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel office-consent show '
             '--consent-id "04e5fd05-ff86-4b97-b8d2-1c20933cb46c" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /OfficeConsents/delete/Delete an office consent.
@try_manual
def step_office_consent_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel office-consent delete -y '
             '--consent-id "04e5fd05-ff86-4b97-b8d2-1c20933cb46c" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ProductSettings/get/Get all settings.
@try_manual
def step_product_setting_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel product-setting list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ProductSettings/get/Get EyesOn settings.
@try_manual
def step_product_setting_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel product-setting show '
             '--resource-group "{rg}" '
             '--settings-name "EyesOn" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ProductSettings/delete/Delete EyesOn settings.
@try_manual
def step_product_setting_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel product-setting delete -y '
             '--resource-group "{rg}" '
             '--settings-name "EyesOn" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SecurityMLAnalyticsSettings/put/Creates or updates a Anomaly Security ML Analytics Settings.
@try_manual
def step_security_ml_analytic_setting_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel security-ml-analytic-setting create '
             '--resource-group "{rg}" '
             '--security-ml-analytics-setting "{{\\"etag\\":\\"\\\\\\"260090e2-0000-0d00-0000-5d6fb8670000\\\\\\"\\",\\'
             '"kind\\":\\"Anomaly\\",\\"properties\\":{{\\"description\\":\\"When account logs from a source region '
             'that has rarely been logged in from during the last 14 days, an anomaly is '
             'triggered.\\",\\"anomalySettingsVersion\\":0,\\"anomalyVersion\\":\\"1.0.5\\",\\"customizableObservations'
             '\\":{{\\"multiSelectObservations\\":null,\\"prioritizeExcludeObservations\\":null,\\"singleSelectObservat'
             'ions\\":[{{\\"name\\":\\"Device vendor\\",\\"description\\":\\"Select device vendor of network '
             'connection logs from CommonSecurityLog\\",\\"rerun\\":\\"RerunAlways\\",\\"sequenceNumber\\":1,\\"support'
             'edValues\\":[\\"Palo Alto Networks\\",\\"Fortinet\\",\\"Check Point\\"],\\"supportedValuesKql\\":null,\\"'
             'value\\":[\\"Palo Alto Networks\\"],\\"valuesKql\\":null}}],\\"singleValueObservations\\":null,\\"thresho'
             'ldObservations\\":[{{\\"name\\":\\"Daily data transfer threshold in MB\\",\\"description\\":\\"Suppress '
             'anomalies when daily data transfered (in MB) per hour is less than the chosen '
             'value\\",\\"maximum\\":\\"100\\",\\"minimum\\":\\"1\\",\\"rerun\\":\\"RerunAlways\\",\\"sequenceNumber\\"'
             ':1,\\"value\\":\\"25\\"}},{{\\"name\\":\\"Number of standard deviations\\",\\"description\\":\\"Triggers '
             'anomalies when number of standard deviations is greater than the chosen value\\",\\"maximum\\":\\"10\\",'
             '\\"minimum\\":\\"2\\",\\"rerun\\":\\"RerunAlways\\",\\"sequenceNumber\\":2,\\"value\\":\\"3\\"}}]}},\\"di'
             'splayName\\":\\"Login from unusual region\\",\\"enabled\\":true,\\"frequency\\":\\"PT1H\\",\\"isDefaultSe'
             'ttings\\":true,\\"requiredDataConnectors\\":[{{\\"connectorId\\":\\"AWS\\",\\"dataTypes\\":[\\"AWSCloudTr'
             'ail\\"]}}],\\"settingsDefinitionId\\":\\"f209187f-1d17-4431-94af-c141bf5f23db\\",\\"settingsStatus\\":\\"'
             'Production\\",\\"tactics\\":[\\"Exfiltration\\",\\"CommandAndControl\\"],\\"techniques\\":[\\"T1037\\",\\'
             '"T1021\\"]}}}}" '
             '--settings-resource-name "f209187f-1d17-4431-94af-c141bf5f23db" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SecurityMLAnalyticsSettings/get/Get a Anomaly Security ML Analytics Settings.
@try_manual
def step_security_ml_analytic_setting_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel security-ml-analytic-setting show '
             '--resource-group "{rg}" '
             '--settings-resource-name "myFirstAnomalySettings" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SecurityMLAnalyticsSettings/get/Get all Security ML Analytics Settings.
@try_manual
def step_security_ml_analytic_setting_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel security-ml-analytic-setting list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SecurityMLAnalyticsSettings/delete/Delete a Security ML Analytics Settings.
@try_manual
def step_security_ml_analytic_setting_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel security-ml-analytic-setting delete -y '
             '--resource-group "{rg}" '
             '--settings-resource-name "f209187f-1d17-4431-94af-c141bf5f23db" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SentinelOnboardingStates/put/Create Sentinel onboarding state
@try_manual
def step_sentinel_onboarding_state_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel sentinel-onboarding-state create '
             '--resource-group "{rg}" '
             '--name "{mySentinelOnboardingState}" '
             '--customer-managed-key false '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SentinelOnboardingStates/get/Get all Sentinel onboarding states
@try_manual
def step_sentinel_onboarding_state_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel sentinel-onboarding-state list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SentinelOnboardingStates/get/Get Sentinel onboarding state
@try_manual
def step_sentinel_onboarding_state_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel sentinel-onboarding-state show '
             '--resource-group "{rg}" '
             '--name "{mySentinelOnboardingState}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SentinelOnboardingStates/delete/Delete Sentinel onboarding state
@try_manual
def step_sentinel_onboarding_state_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel sentinel-onboarding-state delete -y '
             '--resource-group "{rg}" '
             '--name "{mySentinelOnboardingState}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SourceControl/post/Get repository list.
@try_manual
def step_source_control_list_repository(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel source-control list-repository '
             '--repo-type "Github" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SourceControls/put/Creates a source control.
@try_manual
def step_source_control_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel source-control create '
             '--resource-group "{rg}" '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--description "This is a source control" '
             '--content-types "AnalyticRules" "Workbook" '
             '--display-name "My Source Control" '
             '--repo-type "Github" '
             '--branch "master" '
             '--display-url "https://github.com/user/repo" '
             '--path-mapping path="path/to/rules" content-type="AnalyticRules" '
             '--path-mapping path="path/to/workbooks" content-type="Workbook" '
             '--url "https://github.com/user/repo" '
             '--source-control-id "789e0c1f-4a3d-43ad-809c-e713b677b04a" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SourceControls/get/Get a source control.
@try_manual
def step_source_control_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel source-control show '
             '--resource-group "{rg}" '
             '--source-control-id "789e0c1f-4a3d-43ad-809c-e713b677b04a" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SourceControls/get/Get all source controls.
@try_manual
def step_source_control_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel source-control list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /SourceControls/delete/Delete a source control.
@try_manual
def step_source_control_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel source-control delete -y '
             '--resource-group "{rg}" '
             '--source-control-id "789e0c1f-4a3d-43ad-809c-e713b677b04a" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicator/put/Update a threat Intelligence indicator
@try_manual
def step_threat_intelligence_indicator_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator create '
             '--name "d9cd6f0b-96b9-3984-17cd-a779d1e15a93" '
             '--description "debugging indicators" '
             '--confidence 78 '
             '--created-by-ref "contoso@contoso.com" '
             '--display-name "new schema" '
             '--external-references "[]" '
             '--modified "" '
             '--pattern "[url:value = \'https://www.contoso.com\']" '
             '--pattern-type "url" '
             '--revoked false '
             '--source "Azure Sentinel" '
             '--threat-intelligence-tags "new schema" '
             '--threat-types "compromised" '
             '--valid-from "2020-04-15T17:44:00.114052Z" '
             '--valid-until "" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicator/get/View a threat intelligence indicator by name
@try_manual
def step_threat_intelligence_indicator_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator show '
             '--name "e16ef847-962e-d7b6-9c8b-a33e4bd30e47" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicator/post/Append tags to a threat intelligence indicator
@try_manual
def step_threat_intelligence_indicator_append_tag(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator append-tag '
             '--name "d9cd6f0b-96b9-3984-17cd-a779d1e15a93" '
             '--threat-intelligence-tags "tag1" "tag2" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicator/post/Create a new Threat Intelligence
@try_manual
def step_threat_intelligence_indicator(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator create-indicator '
             '--description "debugging indicators" '
             '--confidence 78 '
             '--created-by-ref "contoso@contoso.com" '
             '--display-name "new schema" '
             '--external-references "[]" '
             '--modified "" '
             '--pattern "[url:value = \'https://www.contoso.com\']" '
             '--pattern-type "url" '
             '--revoked false '
             '--source "Azure Sentinel" '
             '--threat-intelligence-tags "new schema" '
             '--threat-types "compromised" '
             '--valid-from "2021-09-15T17:44:00.114052Z" '
             '--valid-until "" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicator/post/Query threat intelligence indicators as per filtering criteria
@try_manual
def step_threat_intelligence_indicator_query_indicator(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator query-indicator '
             '--max-confidence 80 '
             '--max-valid-until "2021-04-25T17:44:00.114052Z" '
             '--min-confidence 25 '
             '--min-valid-until "2021-04-05T17:44:00.114052Z" '
             '--page-size 100 '
             '--sort-by item-key="lastUpdatedTimeUtc" sort-order="descending" '
             '--sources "Azure Sentinel" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicator/post/Replace tags to a Threat Intelligence
@try_manual
def step_threat_intelligence_indicator_replace_tag(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator replace-tag '
             '--name "d9cd6f0b-96b9-3984-17cd-a779d1e15a93" '
             '--etag "\\"0000262c-0000-0800-0000-5e9767060000\\"" '
             '--threat-intelligence-tags "patching tags" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicator/delete/Delete a threat intelligence indicator
@try_manual
def step_threat_intelligence_indicator_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator delete -y '
             '--name "d9cd6f0b-96b9-3984-17cd-a779d1e15a93" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicatorMetrics/get/Get threat intelligence indicators metrics.
@try_manual
def step_threat_intelligence_indicator_metric_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator metric list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /ThreatIntelligenceIndicators/get/Get all threat intelligence indicators
@try_manual
def step_threat_intelligence_indicator_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel threat-intelligence-indicator list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /WatchlistItems/put/Creates or updates a watchlist item.
@try_manual
def step_watchlist_item_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist item create '
             '--resource-group "{rg}" '
             '--watchlist-alias "highValueAsset" '
             '--etag "0300bf09-0000-0000-0000-5c37296e0000" '
             '--items-key-value "{{\\"Business tier\\":\\"10.0.2.0/24\\",\\"Data tier\\":\\"10.0.2.0/24\\",\\"Gateway '
             'subnet\\":\\"10.0.255.224/27\\",\\"Private DMZ in\\":\\"10.0.0.0/27\\",\\"Public DMZ '
             'out\\":\\"10.0.0.96/27\\",\\"Web Tier\\":\\"10.0.1.0/24\\"}}" '
             '--watchlist-item-id "82ba292c-dc97-4dfc-969d-d4dd9e666842" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /WatchlistItems/get/Get a watchlist item.
@try_manual
def step_watchlist_item_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist item show '
             '--resource-group "{rg}" '
             '--watchlist-alias "highValueAsset" '
             '--watchlist-item-id "3f8901fe-63d9-4875-9ad5-9fb3b8105797" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /WatchlistItems/get/Get all watchlist Items.
@try_manual
def step_watchlist_item_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist item list '
             '--resource-group "{rg}" '
             '--watchlist-alias "highValueAsset" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /WatchlistItems/delete/Delete a watchlist Item.
@try_manual
def step_watchlist_item_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist item delete -y '
             '--resource-group "{rg}" '
             '--watchlist-alias "highValueAsset" '
             '--watchlist-item-id "4008512e-1d30-48b2-9ee2-d3612ed9d3ea" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Watchlists/put/Creates or updates a watchlist and bulk creates watchlist items.
@try_manual
def step_watchlist_create(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist create '
             '--resource-group "{rg}" '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--description "Watchlist from CSV content" '
             '--content-type "text/csv" '
             '--display-name "High Value Assets Watchlist" '
             '--items-search-key "header1" '
             '--number-of-lines-to-skip 1 '
             '--provider "Microsoft" '
             '--raw-content "This line will be skipped\\nheader1,header2\\nvalue1,value2" '
             '--source "watchlist.csv" '
             '--source-type "Local file" '
             '--watchlist-alias "highValueAsset" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Watchlists/put/Creates or updates a watchlist.
@try_manual
def step_watchlist_create2(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist create '
             '--resource-group "{rg}" '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--description "Watchlist from CSV content" '
             '--display-name "High Value Assets Watchlist" '
             '--items-search-key "header1" '
             '--provider "Microsoft" '
             '--source "watchlist.csv" '
             '--source-type "Local file" '
             '--watchlist-alias "highValueAsset" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Watchlists/get/Get a watchlist.
@try_manual
def step_watchlist_show(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist show '
             '--resource-group "{rg}" '
             '--watchlist-alias "highValueAsset" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Watchlists/get/Get all watchlists.
@try_manual
def step_watchlist_list(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=checks)


# EXAMPLE: /Watchlists/delete/Delete a watchlist.
@try_manual
def step_watchlist_delete(test, checks=None):
    if checks is None:
        checks = []
    test.cmd('az sentinel watchlist delete -y '
             '--resource-group "{rg}" '
             '--watchlist-alias "highValueAsset" '
             '--workspace-name "myWorkspace"',
             checks=checks)
